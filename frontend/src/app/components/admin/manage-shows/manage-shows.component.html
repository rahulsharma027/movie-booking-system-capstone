<div class="admin-container">
  <div class="page-header">
    <div class="header-content">
      <h1>Manage Shows</h1>
      <p class="subtitle">Schedule and manage movie showtimes across different theaters</p>
    </div>
    <button class="btn btn-primary" (click)="openAddModal()">
      <span>+</span> Add New Show
    </button>
  </div>

  <div class="table-container">
    <table class="data-table">
      <thead>
        <tr>
          <th class="th-id">ID</th>
          <th class="th-movie">Movie</th>
          <th class="th-theater">Theater</th>
          <th class="th-date">Show Date</th>
          <th class="th-time">Show Time</th>
          <th class="th-price">Price</th>
          <th class="th-seats">Seats</th>
          <th class="th-actions">Actions</th>
        </tr>
      </thead>
      <tbody>
        @for (show of shows; track show.id) {
          <tr class="table-row">
            <td class="td-id">{{ show.id }}</td>
            <td class="td-movie">
              <div class="movie-info">
                <strong>{{ show.movie.title }}</strong>
                <span class="meta-text">{{ show.movie.genre }} ‚Ä¢ {{ show.movie.language }}</span>
              </div>
            </td>
            <td class="td-theater">
              <div class="theater-info">
                <strong>{{ show.theater.name }}</strong>
                <span class="meta-text">üìç {{ show.theater.city }}</span>
              </div>
            </td>
            <td class="td-date">
              <span class="date-badge">üìÖ {{ show.showDate | date:'MMM d, y' }}</span>
            </td>
            <td class="td-time">
              <span class="time-badge">üïê {{ show.showTime }}</span>
            </td>
            <td class="td-price">
              <span class="price-badge">‚Çπ{{ show.price }}</span>
            </td>
            <td class="td-seats">
              <div class="seats-info">
                <span class="seats-available">{{ show.availableSeats }}</span>
                <span class="seats-total">/ {{ show.totalSeats }}</span>
              </div>
            </td>
            <td class="td-actions">
              <div class="action-buttons">
                <button class="btn btn-sm btn-edit" (click)="openEditModal(show)" title="Edit Show">
                  <span>‚úèÔ∏è</span> Edit
                </button>
                <button class="btn btn-sm btn-delete" (click)="deleteShow(show.id)" title="Delete Show">
                  <span>üóëÔ∏è</span> Delete
                </button>
              </div>
            </td>
          </tr>
        }
        @empty {
          <tr>
            <td colspan="8" class="empty-state">
              <div class="empty-content">
                <span class="empty-icon">üé≠</span>
                <p>No shows scheduled. Create your first show to get started!</p>
              </div>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  @if (showModal) {
    <div class="modal-overlay" (click)="closeModal()">
      <div class="modal modal-large" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <div class="modal-title-section">
            <h2>{{ editMode ? 'Edit Show' : 'Add New Show' }}</h2>
            <p class="modal-subtitle">{{ editMode ? 'Update show timing and details' : 'Schedule a new movie show' }}</p>
          </div>
          <button class="close-btn" (click)="closeModal()">√ó</button>
        </div>

        <div class="modal-body">
          <div class="form-section">
            <h3 class="section-heading">Show Details</h3>
            
            <div class="form-group">
              <label class="form-label">Select Movie <span class="required">*</span></label>
              <select [(ngModel)]="currentShow.movieId" class="form-control">
                <option value="">-- Choose a movie --</option>
                @for (movie of movies; track movie.id) {
                  <option [value]="movie.id">{{ movie.title }} ({{ movie.language }})</option>
                }
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">Select Theater <span class="required">*</span></label>
              <select [(ngModel)]="currentShow.theaterId" class="form-control">
                <option value="">-- Choose a theater --</option>
                @for (theater of theaters; track theater.id) {
                  <option [value]="theater.id">{{ theater.name }} - {{ theater.city }} ({{ theater.capacity }} seats)</option>
                }
              </select>
            </div>
          </div>

          <div class="form-section">
            <h3 class="section-heading">Schedule & Pricing</h3>
            
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Show Date <span class="required">*</span></label>
                <input 
                  type="date" 
                  [(ngModel)]="currentShow.showDate" 
                  class="form-control"
                />
              </div>

              <div class="form-group">
                <label class="form-label">Show Time <span class="required">*</span></label>
                <input 
                  type="time" 
                  [(ngModel)]="currentShow.showTime" 
                  class="form-control"
                />
              </div>

              <div class="form-group">
                <label class="form-label">Ticket Price (‚Çπ) <span class="required">*</span></label>
                <input 
                  type="number" 
                  [(ngModel)]="currentShow.price" 
                  class="form-control"
                  placeholder="250"
                  min="0"
                />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Total Seats <span class="required">*</span></label>
                <input 
                  type="number" 
                  [(ngModel)]="currentShow.totalSeats" 
                  class="form-control"
                  placeholder="100"
                  min="1"
                />
                <small class="form-hint">üí° Maximum seating capacity for this show</small>
              </div>

              <div class="form-group">
                <label class="form-label">Available Seats <span class="required">*</span></label>
                <input 
                  type="number" 
                  [(ngModel)]="currentShow.availableSeats" 
                  class="form-control"
                  placeholder="100"
                  min="0"
                />
                <small class="form-hint">üí° Seats currently available for booking</small>
              </div>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-outline" (click)="closeModal()">Cancel</button>
          <button class="btn btn-primary btn-large" (click)="saveShow()">
            <span>{{ editMode ? 'üíæ Update Show' : '‚ûï Create Show' }}</span>
          </button>
        </div>
      </div>
    </div>
  }
</div>
